"use strict";(self["webpackChunkthedaoscapefrontend"]=self["webpackChunkthedaoscapefrontend"]||[]).push([[6543],{24521:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Le});var a=o(34182);const r={class:"text-caption on-left"},n=(0,a.createTextVNode)("New Proposal"),s={class:"q-mb-md"},l={key:0,class:"row items-center text-grey-7"};function i(e,t,o,i,c,p){const d=(0,a.resolveComponent)("page-header"),m=(0,a.resolveComponent)("q-icon"),u=(0,a.resolveComponent)("q-item-section"),h=(0,a.resolveComponent)("q-item"),g=(0,a.resolveComponent)("q-list"),v=(0,a.resolveComponent)("q-menu"),x=(0,a.resolveComponent)("q-input"),C=(0,a.resolveComponent)("q-tab"),f=(0,a.resolveComponent)("q-tabs"),N=(0,a.resolveComponent)("q-separator"),b=(0,a.resolveComponent)("proposal-card"),k=(0,a.resolveComponent)("q-page"),_=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createBlock)(k,{padding:"",class:"text-black overflow-hidden constrain-page-width"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{title:"Proposals"}),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(x,{placeholder:"Search",outlined:"",modelValue:e.filter,"onUpdate:modelValue":t[2]||(t[2]=t=>e.filter=t)},{prepend:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{name:"search",class:"cursor-pointer"})])),append:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",r,(0,a.toDisplayString)(e.tabfilter),1),(0,a.createVNode)(m,{name:e.menu_visible?"menu_open":"menu",class:"cursor-pointer"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(v,{fit:"",onBeforeShow:t[0]||(t[0]=t=>e.menu_visible=!0),onHide:t[1]||(t[1]=t=>e.menu_visible=!1)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{style:{"min-width":"100px"},class:"primary-hover-list"},{default:(0,a.withCtx)((()=>[(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(h,{clickable:"",to:`/manage/${e.getActiveGroup}/new-proposal`},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{name:"add_circle"})])),_:1}),(0,a.createVNode)(u,null,{default:(0,a.withCtx)((()=>[n])),_:1})])),_:1},8,["to"])),[[_]])])),_:1})])),_:1})])),_:1},8,["name"])])),_:1},8,["modelValue"]),(0,a.createElementVNode)("div",s,[(0,a.createVNode)(f,{modelValue:e.tabfilter,"onUpdate:modelValue":t[3]||(t[3]=t=>e.tabfilter=t),dense:"",class:"text-primary",align:"left","no-caps":""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{label:"Active",name:"active"}),(0,a.createVNode)(C,{label:"Executed",name:"executed"}),(0,a.createVNode)(C,{label:"Cancelled",name:"cancelled"}),(0,a.createVNode)(C,{label:"Expired",name:"expired"})])),_:1},8,["modelValue"]),(0,a.createVNode)(N)])]),(0,a.createVNode)(a.Transition,{appear:"","enter-active-class":"animated fadeInDown",class:"column q-gutter-md",tag:"div"},{default:(0,a.withCtx)((()=>[e.getProposalsWithFilter.length?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("span",l,[(0,a.createVNode)(m,{name:"error_outline",size:"24px",class:"q-mr-sm"}),(0,a.createTextVNode)(" No "+(0,a.toDisplayString)(e.tabfilter)+" proposals found. ",1)]))])),_:1}),(0,a.createVNode)(a.TransitionGroup,{appear:"","enter-active-class":"animated zoomIn",class:"column q-gutter-md",tag:"div"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.getProposalsWithFilter,(t=>((0,a.openBlock)(),(0,a.createBlock)(b,{proposal:t,key:e.tabfilter+t.id,proposalstate:e.tabfilter},null,8,["proposal","proposalstate"])))),128))])),_:1})])),_:1})}var c=o(55250),p=o(33314);const d=(0,a.defineComponent)({name:"proposalsTable",props:{proposals:{type:Array,default:()=>[]}},data(){return{selected:[],columns:[{name:"title",required:!1,label:"Title",align:"left",field:e=>e.title,sortable:!0},{name:"description",required:!1,label:"Description",align:"left",field:e=>e.description,sortable:!1},{name:"actions",required:!1,label:"action(s)",align:"center",field:e=>e.actions,format:e=>e.map((e=>e.account)).join(", "),sortable:!1},{name:"expiration",required:!0,label:"Expire",align:"left",field:e=>e.expiration,sortable:!0},{name:"proposer",required:!1,label:"Proposer",align:"left",field:e=>e.proposer,sortable:!1},{name:"approvals",required:!1,label:"Approvals",align:"left",field:e=>e.approvals,format:e=>e.join(", "),sortable:!1},{name:"extra",required:!1,label:"",align:"right",sortable:!1}],data:this.proposals}},computed:{...(0,c.Se)({getAccountName:"proton/getAccountName"})},methods:{async cancelJob(e){let t=[{account:"piecestest12",name:"cancel",data:{owner:this.getAccountName,id:e}}],o=await this.$store.dispatch("proton/transact",{actions:t});o&&(this.$emit("executed"),this.data=this.data.filter((t=>t.id!=e)),this.$store.dispatch("user/fetchDeposits",this.getAccountName))}},watch:{}});var m=o(74260),u=o(57678),h=o(18186),g=o(92414),v=o(83884),x=o(2165),C=o(20811),f=o(27011),N=o(83414),b=o(52035),k=o(60677),_=o(7518),V=o.n(_);V()(d,"components",{QTable:u.Z,QTr:h.Z,QTh:g.Z,QTd:v.Z,QBtn:x.Z,QMenu:C.Z,QList:f.Z,QItem:N.Z,QItemSection:b.Z}),V()(d,"directives",{ClosePopup:k.Z});const y={class:"q-pb-xs",style:{"max-width":"100%"}},w={class:"text-secondary"},B=(0,a.createTextVNode)(" Threshold "),I={key:0},T={class:"q-px-md q-pt-xs text-grey-7"},q=(0,a.createElementVNode)("div",{class:"text-weight-bold"},"Description",-1),z=(0,a.createTextVNode)("                "),E={class:"row justify-between text-caption q-px-md text-grey-5"},Z=(0,a.createElementVNode)("b",null,"Expiration",-1),A=(0,a.createElementVNode)("b",null,"ID",-1),S={class:"q-pa-md row justify-between"};function Q(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-spinner"),i=(0,a.resolveComponent)("proposal-icon"),c=(0,a.resolveComponent)("q-tooltip"),p=(0,a.resolveComponent)("q-circular-progress"),d=(0,a.resolveComponent)("q-item-section"),m=(0,a.resolveComponent)("q-item-label"),u=(0,a.resolveComponent)("q-badge"),h=(0,a.resolveComponent)("q-tab"),g=(0,a.resolveComponent)("q-tabs"),v=(0,a.resolveComponent)("q-separator"),x=(0,a.resolveComponent)("approvals-list"),C=(0,a.resolveComponent)("q-tab-panel"),f=(0,a.resolveComponent)("q-markdown"),N=(0,a.resolveComponent)("q-scroll-area"),b=(0,a.resolveComponent)("date-string"),k=(0,a.resolveComponent)("action-display"),_=(0,a.resolveComponent)("q-tab-panels"),V=(0,a.resolveComponent)("trx-id"),Q=(0,a.resolveComponent)("proposal-btns"),D=(0,a.resolveComponent)("q-btn"),G=(0,a.resolveComponent)("q-expansion-item"),P=(0,a.resolveComponent)("q-card");return(0,a.openBlock)(),(0,a.createElementBlock)("div",y,[(0,a.createVNode)(P,{class:(0,a.normalizeClass)(["proposal",{"proposal-voted":e.hasVoted}])},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(G,{class:"primary-hover-list",group:"somegroup","expand-icon-toggle":!1},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{avatar:""},{default:(0,a.withCtx)((()=>[e.is_signing?((0,a.openBlock)(),(0,a.createBlock)(l,{key:0,size:"60px",color:"primary"})):(0,a.createCommentVNode)("",!0),!e.is_signing&&e.getCLOCK>0?((0,a.openBlock)(),(0,a.createBlock)(p,{key:1,"show-value":"",class:"",value:e.getExpirationStats.rel_perc,size:"60px",thickness:.2,color:"primary","center-color":"grey-4","track-color":"grey-3"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",w,[(0,a.createVNode)(i,{actions:e.proposal.actions},null,8,["actions"])]),(0,a.createVNode)(c,{class:"bg-secondary",delay:200,anchor:"center right",self:"center left",offset:[10,10]},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.getExpirationStats.rel_human),1)])),_:1})])),_:1},8,["value","thickness"])):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(d,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{class:"text-weight-light text-h6 text-capitalize"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.proposal.title),1)])),_:1}),(0,a.createVNode)(m,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("Proposed by "+(0,a.toDisplayString)(e.proposal.proposer),1)])),_:1})])),_:1}),(0,a.createVNode)(d,{side:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{caption:""},{default:(0,a.withCtx)((()=>[B,"active"==e.proposalstate?((0,a.openBlock)(),(0,a.createElementBlock)("span",I,(0,a.toDisplayString)(e.getThresholdScore.approved_weight)+"/"+(0,a.toDisplayString)(e.getThresholdScore.threshold),1)):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(u,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.getThresholdScore.threshold_name),1)])),_:1})])),_:1})])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{modelValue:e.tabfilter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tabfilter=t),class:"text-primary",align:"left"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,{label:"About",name:"about"}),(0,a.createVNode)(h,{label:"Actions",name:"actions"},{default:(0,a.withCtx)((()=>[e.proposal.actions.length?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,floating:"",color:"primary",class:"round"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.proposal.actions.length),1)])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(h,{label:"Votes",name:"votes"},{default:(0,a.withCtx)((()=>[e.proposal.approvals.length?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,floating:"",color:"positive",class:"round"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.proposal.approvals.length),1)])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(v),(0,a.createVNode)(_,{modelValue:e.tabfilter,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tabfilter=t),animated:"","transition-prev":"fade","transition-next":"fade"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{name:"votes",class:"overflow-hidden"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{approvals:e.proposal.approvals},null,8,["approvals"])])),_:1}),(0,a.createVNode)(C,{name:"about",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(N,{visible:!0,"thumb-style":e.thumbStyle,style:{height:"200px",width:"100%"}},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",T,[q,(0,a.createVNode)(f,{class:"text-weight-light",src:e.proposal.description,"no-abbreviation":!1},{default:(0,a.withCtx)((()=>[z])),_:1},8,["src"])])])),_:1},8,["thumb-style"]),(0,a.createElementVNode)("div",E,[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(b,{prepend:"Submitted:",date:e.proposal.submitted},null,8,["date"])]),(0,a.createElementVNode)("div",null,[Z,(0,a.createTextVNode)(": "+(0,a.toDisplayString)(e.proposal.expiration),1)]),(0,a.createElementVNode)("div",null,[A,(0,a.createTextVNode)(": "+(0,a.toDisplayString)(e.proposal.id),1)])])])),_:1}),(0,a.createVNode)(C,{name:"actions",class:"overflow-hidden"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(a.TransitionGroup,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"out-in",class:"row q-gutter-sm",tag:"div"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.proposal.actions,((e,t)=>((0,a.openBlock)(),(0,a.createBlock)(k,{key:`${t}${e.name}`,action:e},null,8,["action"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(v),(0,a.createElementVNode)("div",S,[(0,a.createVNode)(V,{trxid:e.proposal.trx_id},null,8,["trxid"]),"active"==e.proposalstate?((0,a.openBlock)(),(0,a.createBlock)(Q,{key:0,proposal:e.proposal,onUseraction:e.handleUserAction},null,8,["proposal","onUseraction"])):(0,a.createCommentVNode)("",!0),"executed"==e.proposalstate?((0,a.openBlock)(),(0,a.createBlock)(D,{key:1,unelevated:"",label:`executed by ${e.proposal.last_actor}`,color:"primary",size:"sm"},null,8,["label"])):(0,a.createCommentVNode)("",!0),"cancelled"==e.proposalstate?((0,a.openBlock)(),(0,a.createBlock)(D,{key:2,unelevated:"",label:`cancelled by ${e.proposal.last_actor}`,color:"negative",size:"sm"},null,8,["label"])):(0,a.createCommentVNode)("",!0)])])),_:1})])),_:1},8,["class"])])}var D=o(85054);const G={key:0,class:"row justify-end"},P={key:1,class:"row justify-end"};function $(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-btn");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.getAccountName&&e.proposal&&e.getIsGuardian(e.getAccountName)?((0,a.openBlock)(),(0,a.createElementBlock)("div",G,[e.isProposer?((0,a.openBlock)(),(0,a.createBlock)(l,{key:0,label:"cancel",class:"q-mr-xs",flat:"",color:"negative",size:"sm",onClick:t[0]||(t[0]=t=>e.$emit("useraction",{type:"cancel",id:e.proposal.id})),disabled:e.getIsTransacting},null,8,["disabled"])):(0,a.createCommentVNode)("",!0),e.getUserHasApproved||e.getIsExecutable?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createBlock)(l,{key:1,label:"approve",color:"positive",size:"sm",onClick:t[1]||(t[1]=t=>e.$emit("useraction",{type:"approve",id:e.proposal.id})),disabled:e.getIsTransacting},null,8,["disabled"])),e.getUserHasApproved&&!e.getIsExecutable?((0,a.openBlock)(),(0,a.createBlock)(l,{key:2,label:"unapprove",color:"negative",size:"sm",onClick:t[2]||(t[2]=t=>e.$emit("useraction",{type:"unapprove",id:e.proposal.id})),disabled:e.getIsTransacting},null,8,["disabled"])):(0,a.createCommentVNode)("",!0),e.getIsExecutable?((0,a.openBlock)(),(0,a.createBlock)(l,{key:3,label:"execute",color:"primary",size:"sm",onClick:t[3]||(t[3]=t=>e.$emit("useraction",{type:"exec",id:e.proposal.id})),disabled:e.getIsTransacting},null,8,["disabled"])):(0,a.createCommentVNode)("",!0)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",P,[(0,a.createVNode)(l,{label:"login as guardian",size:"sm",flat:"",onClick:t[4]||(t[4]=t=>e.$store.dispatch("proton/login")),color:"primary",disabled:e.getIsTransacting},null,8,["disabled"])]))])}const L=(0,a.defineComponent)({name:"proposalBtns",components:{},props:{proposal:{type:Object,default:()=>({})}},data(){return{}},computed:{...(0,c.Se)({getAccountName:"proton/getAccountName",getIsGuardian:"group/getIsGuardian",getThresholdByName:"group/getThresholdByName",getThresholds:"group/getThresholds",getIsTransacting:"proton/getIsTransacting"}),getUserHasApproved(){if(this.proposal&&this.proposal.approvals&&this.getAccountName)return this.proposal.approvals.includes(this.getAccountName)},getIsExecutable(){if(this.proposal&&this.proposal.approvals&&this.getAccountName&&this.getThresholds.length){const e=this.getThresholdByName(this.proposal.required_threshold).threshold;let t=0;return this.proposal.approvals.forEach((e=>{const o=this.getIsGuardian(e);o&&(t+=o.weight)})),t>=e}},isProposer(){if(this.proposal&&this.proposal.proposer&&this.getAccountName)return this.getAccountName==this.proposal.proposer}},methods:{}}),O=(0,m.Z)(L,[["render",$]]),M=O;V()(L,"components",{QBtn:x.Z});const F={key:"no_approvals"},K=(0,a.createTextVNode)("No approvals"),U=(0,a.createTextVNode)("Threshold not met"),j=(0,a.createTextVNode)(" Ex Guardian ");function R(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-item-label"),i=(0,a.resolveComponent)("q-item-section"),c=(0,a.resolveComponent)("q-item"),p=(0,a.resolveComponent)("profile-pic"),d=(0,a.resolveComponent)("q-card");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(a.TransitionGroup,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"out-in",class:"row q-gutter-sm",tag:"div"},{default:(0,a.withCtx)((()=>[e.approvals.length?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",F,[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(l,{class:"text-capitalize"},{default:(0,a.withCtx)((()=>[K])),_:1}),(0,a.createVNode)(l,{caption:""},{default:(0,a.withCtx)((()=>[U])),_:1})])),_:1})])),_:1})])),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.approvals,(t=>((0,a.openBlock)(),(0,a.createBlock)(d,{class:(0,a.normalizeClass)(["guardian-card shadow-1",e.$q.dark.isActive?"bg-secondary":""]),key:`a${t}`},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{size:42,icon:"check",iconColor:"positive",account:t},null,8,["account"])])),_:2},1024),(0,a.createVNode)(i,{style:{"margin-left":"-7px"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(l,{class:"text-capitalize"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t),1)])),_:2},1024),e.getIsGuardian(t)?((0,a.openBlock)(),(0,a.createBlock)(l,{key:0,caption:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Weight "+(0,a.toDisplayString)(e.getIsGuardian(t).weight),1)])),_:2},1024)):((0,a.openBlock)(),(0,a.createBlock)(l,{key:1,caption:""},{default:(0,a.withCtx)((()=>[j])),_:1}))])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1})])}var W=o(37446);const H=(0,a.defineComponent)({name:"approvalsList",components:{profilePic:W.Z},props:{approvals:{type:Array,default:()=>[]}},data(){return{}},computed:{...(0,c.Se)({getIsGuardian:"group/getIsGuardian"})},methods:{}});var J=o(2350),Y=o(10151);const X=(0,m.Z)(H,[["render",R]]),ee=X;V()(H,"components",{QItem:N.Z,QItemSection:b.Z,QItemLabel:J.Z,QCard:Y.Z});const te=(0,a.createElementVNode)("span",{class:"text-primary q-mx-xs"},[(0,a.createElementVNode)("b",null,">")],-1),oe={style:{"word-break":"break-word"}};function ae(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-icon"),i=(0,a.resolveComponent)("q-item-section"),c=(0,a.resolveComponent)("q-badge"),p=(0,a.resolveComponent)("q-item-label"),d=(0,a.resolveComponent)("q-spinner"),m=(0,a.resolveComponent)("q-item"),u=(0,a.resolveComponent)("q-list"),h=(0,a.resolveComponent)("q-card");return(0,a.openBlock)(),(0,a.createBlock)(h,{class:"shadow-1 overflow-hidden"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(u,{class:"primary-hover-list overflow-hidden"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{clickable:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(l,{name:e.getIconForAction(e.deserialized_action.name).name,class:(0,a.normalizeClass)(e.getIconForAction(e.deserialized_action.name).class?e.getIconForAction(e.deserialized_action.name).class:"")},null,8,["name","class"])])),_:1}),(0,a.createVNode)(i,{style:{"margin-left":"-15px"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.deserialized_action.account),1),te,(0,a.createTextVNode)((0,a.toDisplayString)(e.deserialized_action.name)+" ",1),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.action.authorization,(e=>((0,a.openBlock)(),(0,a.createBlock)(c,{key:e.actor+e.permission,class:"q-ml-xs"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(`${e.actor}@${e.permission}`),1)])),_:2},1024)))),128))])),_:1}),e.is_deserializing?((0,a.openBlock)(),(0,a.createBlock)(p,{key:1,caption:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{color:"primary"})])),_:1})):((0,a.openBlock)(),(0,a.createBlock)(p,{key:0,caption:""},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",oe,(0,a.toDisplayString)(e.deserialized_action.data),1)])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1})}const re={transfer:{name:"import_export",size:"40px",class:"rotate-90"},invitecust:{name:"mdi-account-plus",size:"30px"},removecust:{name:"mdi-account-minus",size:"30px"},updateurl:{name:"link",size:"30px"},updateabout:{name:"format_align_center",size:"30px"},updatelogo:{name:"art_track",size:"35px"},updatecolor:{name:"color_lens",size:"35px"},updatetags:{name:"mdi-tag",size:"30px"},manthreshold:{name:"mdi-chart-gantt",size:"30px",class:"rotate-270"},buyram:{name:"mdi-alpha-r-circle",size:"30px"},sellram:{name:"mdi-alpha-r-circle",size:"30px"},paymentadd:{name:"mdi-account-cash",size:"30px"},paymentrem:{name:"mdi-cash-remove",size:"30px"},payrollreg:{name:"mdi-cash-register",size:"30px"},linkmodule:{name:"mdi-view-module",size:"30px"},DEFAULT:{name:"settings",size:"35px"},get:function(e){let t=re[e];return t||re.DEFAULT}},ne=(0,a.defineComponent)({name:"actionDisplay",props:{action:{type:Object,default:()=>({})}},data(){return{deserialized_action:!1,authorization:"",is_deserializing:!1}},computed:{...(0,c.Se)({getIsGuardian:"group/getIsGuardian"})},methods:{getIconForAction(e){return re.get(e)},async deserializeAction(){if("string"==typeof this.action.data){this.is_deserializing=!0;const e=await this.$eos.api.getContract(this.action.account);let t=await this.$eos.Serialize.deserializeAction(e,this.action.account,this.action.name,this.action.authorization,this.action.data);return this.is_deserializing=!1,t}return this.action.data}},watch:{action:{handler:async function(e,t){e&&e!=t&&"string"==typeof this.action.data&&(this.deserialized_action=await this.deserializeAction())},immediate:!0}}});var se=o(24554),le=o(69721),ie=o(6833);const ce=(0,m.Z)(ne,[["render",ae]]),pe=ce;V()(ne,"components",{QCard:Y.Z,QList:f.Z,QItem:N.Z,QItemSection:b.Z,QIcon:se.Z,QItemLabel:J.Z,QBadge:le.Z,QSpinner:ie.Z});const de={class:"relative-position"},me={key:0,class:"absolute",style:{"font-size":"10px",top:"4px",left:"3px"}};function ue(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-icon");return(0,a.openBlock)(),(0,a.createElementBlock)("div",de,[(0,a.createVNode)(a.Transition,{appear:"","enter-active-class":"animated fadeIn",mode:"out-in"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.active_icon_index},[(0,a.createVNode)(l,{name:e.getMatchedIcons[e.active_icon_index].name,class:(0,a.normalizeClass)(e.getMatchedIcons[e.active_icon_index].class?e.getMatchedIcons[e.active_icon_index].class:""),size:e.getMatchedIcons[e.active_icon_index].size},null,8,["name","class","size"]),e.getMatchedIcons[e.active_icon_index].count>1?((0,a.openBlock)(),(0,a.createElementBlock)("div",me," x"+(0,a.toDisplayString)(e.getMatchedIcons[e.active_icon_index].count),1)):(0,a.createCommentVNode)("",!0)]))])),_:1})])}const he=(0,a.defineComponent)({name:"proposalIcon",props:{actions:{type:Array,default:()=>[]}},data(){return{active_icon_index:0}},computed:{getMatchedIcons(){let e=[];for(let t=0;t<this.actions.length;t++){let o=this.actions[t],a=re.get(o.name),r=e.findIndex((e=>e.name==a.name));-1!=r?e[r].count++:(a.count=1,e.push(a))}return e}},methods:{updateIconIndex(){let e=this.getMatchedIcons.length;e-1==this.active_icon_index?this.active_icon_index=0:this.active_icon_index++}},mounted(){this.getMatchedIcons.length>1&&(this.icon_timer=setInterval((()=>{this.updateIconIndex()}),5e3))},beforeDestroy(){clearInterval(this.icon_timer),this.icon_timer=null}}),ge=(0,m.Z)(he,[["render",ue]]),ve=ge;V()(he,"components",{QIcon:se.Z});const xe=["href"],Ce=(0,a.createElementVNode)("span",null,"explore",-1);function fe(e,t,o,r,n,s){const l=(0,a.resolveComponent)("q-icon");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createElementVNode)("a",{href:e.getSelectedBlockExplorer.base+e.getSelectedBlockExplorer.trx+e.trxid,target:"_blank",class:"text-link row items-center"},[(0,a.createVNode)(l,{name:"search",size:"16px"}),Ce],8,xe)])}const Ne=(0,a.defineComponent)({name:"trxId",props:{trxid:{type:String,default:""}},data(){return{blok_explorer:"https://jungle.eosq.app/tx/"}},computed:{...(0,c.Se)({getIsGuardian:"group/getIsGuardian",getSelectedBlockExplorer:"user/getSelectedBlockExplorer"})}}),be=(0,m.Z)(Ne,[["render",fe]]),ke=be;V()(Ne,"components",{QIcon:se.Z});o(24613);var _e=o(16336),Ve=o(40019);const ye=(0,a.defineComponent)({name:"proposalCard",components:{proposalBtns:M,approvalsList:ee,actionDisplay:pe,trxId:ke,proposalIcon:ve,dateString:D.Z},props:{proposal:{type:Object,default:()=>({})},proposalstate:{type:String,default:""}},data(){return{is_signing:!1,tabfilter:"about",thumbStyle:{right:"0px",borderRadius:"5px",backgroundColor:"#7DC6EC",width:"5px",opacity:.75}}},computed:{...(0,c.Se)({getAccountName:"proton/getAccountName",getIsTransacting:"proton/getIsTransacting",getActiveGroup:"group/getActiveGroup",getGroupWallet:"group/getGroupWallet",getThresholdByName:"group/getThresholdByName",getIsGuardian:"group/getIsGuardian",getCLOCK:"app/getCLOCK"}),hasVoted(){let e=!1;return this.getAccountName&&(e=this.proposal.approvals.includes(this.getAccountName)),e},getThresholdScore(){let e={approved_weight:0,threshold:"",threshold_name:""},t=this.getThresholdByName(this.proposal.required_threshold);return this.proposal&&this.proposal.approvals&&t&&(e.threshold=t.threshold,e.threshold_name=t.threshold_name,this.proposal.approvals.forEach((t=>{const o=this.getIsGuardian(t);o&&(e.approved_weight+=o.weight)}))),e},getExpirationStats(){let e=new Date(this.proposal.submitted+".000+00:00").getTime(),t=new Date(this.proposal.expiration+".000+00:00").getTime(),o=t-e,a=this.getCLOCK,r=t-a;return r=r<=0?0:r,{rel_human:r?"Proposal will expire in "+(0,_e.YE)(r/1e3):"Proposal expired",rel_perc:r/o*100}}},methods:{async handleUserAction(e){Ve.log(e);const t=e.id,o=e.type;let a,r={account:this.getActiveGroup,name:o,data:{id:t}};switch(o){case"approve":r.data.approver=this.getAccountName,a=await this.push(r)?this.proposal.approvals.push(this.getAccountName):null;break;case"unapprove":r.data.unapprover=this.getAccountName,a=await this.push(r),a&&(this.proposal.approvals=this.proposal.approvals.filter((e=>e!=this.getAccountName)));break;case"cancel":r.data.canceler=this.getAccountName,await this.push(r)&&this.$store.commit("group/deleteProposalById",this.proposal.id);break;case"exec":r.data.executer=this.getAccountName;let e=await this.push(r);e&&(this.$store.commit("group/deleteProposalById",this.proposal.id),setTimeout((()=>{this.$store.dispatch("group/loadGroupRoutine",{groupname:this.getActiveGroup,vm:this})}),2e3));break;default:break}},async push(e){this.is_signing=!0;let t=await this.$store.dispatch("proton/transact",{actions:[e],disable_signing_overlay:!0});return t&&t.trxid?(this.is_signing=!1,!0):(this.is_signing=!1,!1)}}});var we=o(60429),Be=o(86122),Ie=o(5363),Te=o(57547),qe=o(58408),ze=o(65869),Ee=o(5906),Ze=o(86602),Ae=o(47704);const Se=(0,m.Z)(ye,[["render",Q]]),Qe=Se;V()(ye,"components",{QCard:Y.Z,QExpansionItem:we.Z,QItemSection:b.Z,QSpinner:ie.Z,QCircularProgress:Be.Z,QTooltip:Ie.Z,QItemLabel:J.Z,QBadge:le.Z,QTabs:Te.Z,QTab:qe.Z,QSeparator:ze.Z,QTabPanels:Ee.Z,QTabPanel:Ze.Z,QScrollArea:Ae.Z,QBtn:x.Z});const De=(0,a.defineComponent)({components:{pageHeader:p.Z,proposalCard:Qe},data(){return{menu_visible:!1,tabfilter:"active",filter:""}},methods:{},computed:{...(0,c.Se)({getAccountName:"proton/getAccountName",getProposals:"group/getProposals",getActiveGroup:"group/getActiveGroup",getCLOCK:"app/getCLOCK"}),getProposalsWithFilter(){return"active"==this.tabfilter?this.getProposals.active:"executed"==this.tabfilter?this.getProposals.executed:"cancelled"==this.tabfilter?this.getProposals.cancelled:"expired"==this.tabfilter?[]:void 0}},mounted(){this.CLOCK_TIMER&&this.getCLOCK||(this.$store.commit("app/setCLOCK",Date.now()),this.CLOCK_TIMER=setInterval((()=>{this.$store.commit("app/setCLOCK",Date.now())}),1e3)),this.$store.dispatch("group/fetchProposals",{groupname:this.getActiveGroup,scope:this.getActiveGroup,vm:this}),this.$store.dispatch("group/fetchProposals",{groupname:this.getActiveGroup,scope:"cancelled",vm:this}),this.$store.dispatch("group/fetchProposals",{groupname:this.getActiveGroup,scope:"executed",vm:this})},beforeDestroy(){clearInterval(this.CLOCK_TIMER),this.CLOCK_TIMER=null}});var Ge=o(24379),Pe=o(64689);const $e=(0,m.Z)(De,[["render",i]]),Le=$e;V()(De,"components",{QPage:Ge.Z,QInput:Pe.Z,QIcon:se.Z,QMenu:C.Z,QList:f.Z,QItem:N.Z,QItemSection:b.Z,QTabs:Te.Z,QTab:qe.Z,QSeparator:ze.Z}),V()(De,"directives",{ClosePopup:k.Z})}}]);