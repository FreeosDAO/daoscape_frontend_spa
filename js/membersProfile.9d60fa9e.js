"use strict";(self["webpackChunkthedaoscapefrontend"]=self["webpackChunkthedaoscapefrontend"]||[]).push([[994],{27332:(e,t,o)=>{o.r(t),o.d(t,{default:()=>wt});var a=o(34182);const n={class:"row q-col-gutter-md"},r={class:"col-xs-12"},l={key:0,class:"col-xs-12"},i={class:"col-xs-12"},c={key:"t"},s={key:2,class:"absolute-right overflow-hidden"},d=(0,a.createTextVNode)(" Click update when you are ready. "),m={class:"row justify-between items-center"},p={key:0,class:"text-caption text-grey"};function u(e,t,o,u,g,h){const f=(0,a.resolveComponent)("profile-header"),v=(0,a.resolveComponent)("display-votes"),_=(0,a.resolveComponent)("q-icon"),C=(0,a.resolveComponent)("q-tab"),y=(0,a.resolveComponent)("q-tooltip"),k=(0,a.resolveComponent)("q-btn"),w=(0,a.resolveComponent)("q-tabs"),N=(0,a.resolveComponent)("q-separator"),V=(0,a.resolveComponent)("text-edit"),x=(0,a.resolveComponent)("q-tab-panel"),B=(0,a.resolveComponent)("profile-text"),b=(0,a.resolveComponent)("profile-links"),Z=(0,a.resolveComponent)("profile-files"),q=(0,a.resolveComponent)("profileGallery"),A=(0,a.resolveComponent)("my-payments"),E=(0,a.resolveComponent)("q-tab-panels"),I=(0,a.resolveComponent)("date-string"),Q=(0,a.resolveComponent)("q-card-section"),S=(0,a.resolveComponent)("q-card"),P=(0,a.resolveComponent)("q-page");return(0,a.openBlock)(),(0,a.createBlock)(P,{padding:"",class:"constrain-page-width"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",n,[(0,a.createElementVNode)("div",r,[(0,a.createVNode)(f,{account:e.account},null,8,["account"])]),e.getElectionsContract&&e.userVotes?((0,a.openBlock)(),(0,a.createElementBlock)("div",l,[(0,a.createVNode)(v,{votes:e.userVotes},null,8,["votes"])])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",i,[e.profile_data?((0,a.openBlock)(),(0,a.createBlock)(S,{key:0},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{modelValue:e.active_tab,"onUpdate:modelValue":t[2]||(t[2]=t=>e.active_tab=t),class:"text-primary",dense:"",align:"left"},{default:(0,a.withCtx)((()=>[e.account==e.getAccountName?((0,a.openBlock)(),(0,a.createBlock)(C,{key:0,class:"text-grey",name:"text",onMouseover:t[0]||(t[0]=t=>e.edit_tab_show=!0),onMouseout:t[1]||(t[1]=t=>e.edit_tab_show=!1)},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(_,{name:"edit",class:"q-mr-xs"}),(0,a.withDirectives)((0,a.createElementVNode)("span",c,"edit",512),[[a.vShow,e.edit_tab_show]])])])),_:1})):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(C,{label:"Profile",name:"textview"},{default:(0,a.withCtx)((()=>[e.isProfileChanged&&e.isProfileChanged.find((e=>"text"==e.path))?((0,a.openBlock)(),(0,a.createBlock)(_,{key:0,name:"mdi-pencil"})):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(C,{label:`Links (${e.profile_data.links.length})`,name:"links"},{default:(0,a.withCtx)((()=>[e.isProfileChanged&&e.isProfileChanged.find((e=>"links"==e.path))?((0,a.openBlock)(),(0,a.createBlock)(_,{key:0,name:"mdi-pencil"})):(0,a.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,a.createVNode)(C,{label:`Gallery (${e.profile_data.gallery.length})`,name:"gallery"},{default:(0,a.withCtx)((()=>[e.isProfileChanged&&e.isProfileChanged.find((e=>"gallery"==e.path))?((0,a.openBlock)(),(0,a.createBlock)(_,{key:0,name:"mdi-pencil"})):(0,a.createCommentVNode)("",!0)])),_:1},8,["label"]),e.mutated_load_my_payments?((0,a.openBlock)(),(0,a.createBlock)(C,{key:1,label:"my payments",name:"mypayments"})):(0,a.createCommentVNode)("",!0),e.profile_data&&e.profile_data.account==e.getAccountName?((0,a.openBlock)(),(0,a.createElementBlock)("div",s,[(0,a.createVNode)(a.Transition,{"enter-active-class":"animated fadeInRight","leave-active-class":"animated fadeOutRight"},{default:(0,a.withCtx)((()=>[e.isProfileChanged?((0,a.openBlock)(),(0,a.createBlock)(k,{key:0,class:(0,a.normalizeClass)((e.isProfileChanged,"")),label:"update",color:"primary",onClick:e.updateProfileDataKey,loading:e.is_transacting},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(y,{class:"bg-secondary",delay:700},{default:(0,a.withCtx)((()=>[d])),_:1})])),_:1},8,["class","onClick","loading"])):(0,a.createCommentVNode)("",!0)])),_:1})])):(0,a.createCommentVNode)("",!0)])),_:1},8,["modelValue"]),(0,a.createVNode)(N),(0,a.createVNode)(E,{modelValue:e.active_tab,"onUpdate:modelValue":t[3]||(t[3]=t=>e.active_tab=t),animated:"","transition-prev":"fade","transition-next":"fade"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{name:"text",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{account:e.account,profile_data:e.profile_data},null,8,["account","profile_data"])])),_:1}),(0,a.createVNode)(x,{name:"textview",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(B,{account:e.account,profile_data:e.profile_data,class:"q-mt-md"},null,8,["account","profile_data"])])),_:1}),(0,a.createVNode)(x,{name:"links",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(b,{account:e.account,profile_data:e.profile_data,class:"q-mt-md"},null,8,["account","profile_data"])])),_:1}),(0,a.createVNode)(x,{name:"files",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{account:e.account,profile_data:e.profile_data},null,8,["account","profile_data"])])),_:1}),(0,a.createVNode)(x,{name:"gallery",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(q,{account:e.account,profile_data:e.profile_data},null,8,["account","profile_data"])])),_:1}),(0,a.createVNode)(x,{name:"mypayments",class:"overflow-hidden no-padding"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(A,{payments:e.my_payments,class:"q-mt-md"},null,8,["payments"])])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)(N,{class:"q-my-md"}),(0,a.createElementVNode)("div",m,[e.profile_data?((0,a.openBlock)(),(0,a.createElementBlock)("div",p,[(0,a.createVNode)(I,{prepend:"Updated:",date:e.profile_data.last_update},null,8,["date"])])):(0,a.createCommentVNode)("",!0)])])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0)])])])),_:1})}var g=o(10741),h=o(56568);const f={key:0},v={class:"row justify-end items-center"},_=(0,a.createTextVNode)(" Explore "),C={key:1},y={class:"q-mb-md"},k={class:"q-gutter-md"},w=(0,a.createTextVNode)(" Unregister as member. "),N=(0,a.createTextVNode)(" Clear all profile data inclusive avatar. This requires a page reload. "),V={class:"q-mt-md"};function x(e,t,o,n,r,l){const i=(0,a.resolveComponent)("profile-pic"),c=(0,a.resolveComponent)("q-item-section"),s=(0,a.resolveComponent)("q-item-label"),d=(0,a.resolveComponent)("q-item"),m=(0,a.resolveComponent)("update-profile-pic"),p=(0,a.resolveComponent)("q-tooltip"),u=(0,a.resolveComponent)("q-btn"),g=(0,a.resolveComponent)("date-string"),h=(0,a.resolveComponent)("q-card-section"),x=(0,a.resolveComponent)("q-list"),B=(0,a.resolveComponent)("q-btn-dropdown"),b=(0,a.resolveComponent)("q-card"),Z=(0,a.resolveComponent)("page-header"),q=(0,a.resolveComponent)("latest-userterms"),A=(0,a.resolveComponent)("q-dialog"),E=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(b,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(a.Transition,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",mode:"out-in"},{default:(0,a.withCtx)((()=>["header"==e.view?((0,a.openBlock)(),(0,a.createBlock)(h,{key:"header"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(d,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,{avatar:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{style:{"margin-left":"-15px"},size:85,iconColor:"white",iconBackground:"bg-primary",account:e.account,tooltip:!1,icon:e.account==e.getAccountName?"mdi-plus":"",onIconClick:t[0]||(t[0]=t=>e.edit_avatar=!e.edit_avatar)},null,8,["account","icon"])])),_:1}),(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(s,{class:"text-weight-light text-h5"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.account),1)])),_:1}),(0,a.createVNode)(s,{caption:""},{default:(0,a.withCtx)((()=>[e.getIsGuardian(e.account)?((0,a.openBlock)(),(0,a.createElementBlock)("span",f,"Guardian")):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(a.Transition,{appear:"","enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeOut"},{default:(0,a.withCtx)((()=>[e.edit_avatar?((0,a.openBlock)(),(0,a.createBlock)(m,{key:0,onUpdated:t[1]||(t[1]=t=>e.edit_avatar=!1)})):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createElementVNode)("div",v,[(0,a.createVNode)(u,{onClick:t[2]||(t[2]=t=>e.openURL(e.getSelectedBlockExplorer.base+e.getSelectedBlockExplorer.account+e.account)),class:"q-mr-xs",icon:"search",color:"primary",size:"xs",round:"",dense:"",flat:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{class:"bg-secondary",delay:500},{default:(0,a.withCtx)((()=>[_,(0,a.createElementVNode)("b",null,(0,a.toDisplayString)(e.account),1),(0,a.createTextVNode)(" on "+(0,a.toDisplayString)(e.getSelectedBlockExplorer.base),1)])),_:1})])),_:1}),e.is_member?((0,a.openBlock)(),(0,a.createBlock)(g,{key:0,prepend:"Member since:",date:e.is_member.member_since},null,8,["date"])):((0,a.openBlock)(),(0,a.createElementBlock)("div",C,"Not yet a member"))])])),_:1})):"more"==e.view?((0,a.openBlock)(),(0,a.createBlock)(h,{key:"more"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",y,[(0,a.createVNode)(i,{size:36,iconBackground:"bg-primary",account:e.account,tooltip:!1},null,8,["account"]),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.account),1)]),(0,a.createElementVNode)("div",k,[e.getIsMember?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,label:"unregister",color:"primary",onClick:e.unregmember,loading:e.is_unregging},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{class:"bg-secondary",delay:500},{default:(0,a.withCtx)((()=>[w])),_:1})])),_:1},8,["onClick","loading"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(u,{label:"delete profile",color:"primary",onClick:e.delprofile,loading:e.is_clearing_profile},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{class:"bg-secondary",delay:500},{default:(0,a.withCtx)((()=>[N])),_:1})])),_:1},8,["onClick","loading"]),e.getIsMember&&e.userterms_enabled?((0,a.openBlock)(),(0,a.createBlock)(B,{key:1,color:"primary",label:e.getRequireUsertermsAgreement?"you have not agreed the latest userterms":`Agreed v${e.getIsMember.agreed_userterms_version}`,split:!0,icon:e.getRequireUsertermsAgreement?"mdi-alert":"mdi-check",modelValue:e.userterms_dropdown_open,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userterms_dropdown_open=t),onClick:t[7]||(t[7]=t=>e.userterms_dropdown_open=!0),loading:e.is_signing_terms},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{class:"primary-hover-list"},{default:(0,a.withCtx)((()=>[e.getRequireUsertermsAgreement?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(d,{key:0,clickable:"",onClick:t[3]||(t[3]=t=>e.signuserterms(!0))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(s,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("Agree userterms v"+(0,a.toDisplayString)(e.getLatestUserterms.id),1)])),_:1})])),_:1})])),_:1})),[[E]]):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(d,{key:1,clickable:"",onClick:t[4]||(t[4]=t=>e.signuserterms(!1))},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(s,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("Disagree userterms v"+(0,a.toDisplayString)(e.getLatestUserterms.id),1)])),_:1})])),_:1})])),_:1})),[[E]]),(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(d,{clickable:"",onClick:t[5]||(t[5]=t=>e.userterms_modal=!0)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(s,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)("View latest userterms v"+(0,a.toDisplayString)(e.getLatestUserterms.id),1)])),_:1})])),_:1})])),_:1})),[[E]])])),_:1})])),_:1},8,["label","icon","modelValue","loading"])):(0,a.createCommentVNode)("",!0)])])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1}),e.account==e.getAccountName?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,icon:"header"==e.view?"mdi-dots-vertical":"mdi-close",flat:"",round:"",dense:"",class:"absolute-top-right q-ma-md",onClick:e.changeView},null,8,["icon","onClick"])):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(A,{modelValue:e.userterms_modal,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userterms_modal=t),maximized:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(b,{class:"overflow-hidden"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{title:`Userterms v${e.getLatestUserterms.id}`},null,8,["title"]),(0,a.withDirectives)((0,a.createVNode)(u,{icon:"close",flat:"",round:"",dense:"",class:"q-ma-md absolute-top-right"},null,512),[[E]]),(0,a.createElementVNode)("div",V,[(0,a.createVNode)(q,{signButtons:""})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var B=o(37446);function b(e,t,o,n,r,l){const i=(0,a.resolveComponent)("profile-pic"),c=(0,a.resolveComponent)("q-btn"),s=(0,a.resolveComponent)("q-input");return(0,a.openBlock)(),(0,a.createBlock)(s,{ref:"input",modelValue:e.new_avatar,"onUpdate:modelValue":t[2]||(t[2]=t=>e.new_avatar=t),label:"new avatar url",outlined:"","bottom-slots":"",onInput:e.load_new_avatar,rules:[e=>!!e||"* Required",e.isHttps,e.isValidUrl]},{append:(0,a.withCtx)((()=>[])),prepend:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{size:40,url:e.new_avatar,onLoaded:t[0]||(t[0]=t=>e.new_avatar_loaded=!0),onError:t[1]||(t[1]=t=>e.new_avatar_loaded=!1)},null,8,["url"])])),after:(0,a.withCtx)((()=>[(0,a.createVNode)(c,{icon:"check",round:"",color:"primary",onClick:e.update_avatar,disabled:!e.new_avatar_is_valid,loading:e.is_transacting},null,8,["onClick","disabled","loading"])])),_:1},8,["modelValue","onInput","rules"])}var Z=o(47592);const q=(0,a.defineComponent)({name:"editProfilePic",components:{profilePic:B.Z},props:{},data(){return{new_avatar:"",new_avatar_loaded:!1,is_transacting:!1}},computed:{...(0,g.Se)({getAvatar:"group/getAvatar",getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup"}),new_avatar_is_valid(){let e=!1;return this.new_avatar!=this.getAvatar(this.getAccountName)&&this.new_avatar_loaded&&!this.$refs.input.hasError&&(e=!0),e}},mounted(){this.new_avatar=this.getAvatar(this.getAccountName)||""},methods:{isValidUrl:Z.jv,isHttps:Z.Qm,load_new_avatar(e){this.new_avatar=e.trim()},async update_avatar(){this.is_transacting=!0;let e={account:this.getActiveGroup,name:"updateavatar",data:{actor:this.getAccountName,img_url:this.new_avatar}},t=await this.$store.dispatch("proton/transact",{actions:[e],disable_signing_overlay:!0});t&&t.trxid?(this.$store.commit("group/updateAvatar",{account:this.getAccountName,img_url:this.new_avatar}),this.$emit("updated")):this.$emit("error"),this.is_transacting=!1}}});var A=o(74260),E=o(64689),I=o(24554),Q=o(2165),S=o(7518),P=o.n(S);const U=(0,A.Z)(q,[["render",b]]),L=U;P()(q,"components",{QInput:E.Z,QIcon:I.Z,QBtn:Q.Z});var T=o(85054),M=o(58094),$=o(33314),D=o(33437);const G=(0,a.defineComponent)({name:"profileHeader",props:{account:""},components:{profilePic:B.Z,updateProfilePic:L,dateString:T.Z,latestUserterms:M.Z,pageHeader:$.Z},data(){return{edit_avatar:!1,view:"header",is_unregging:!1,is_clearing_profile:!1,userterms_dropdown_open:!1,is_signing_terms:!1,is_member:!1,userterms_modal:!1}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup",getIsGuardian:"group/getIsGuardian",getIsMember:"user/getIsMember",getSelectedBlockExplorer:"user/getSelectedBlockExplorer",getRequireUsertermsAgreement:"user/getRequireUsertermsAgreement",getLatestUserterms:"group/getLatestUserterms",getCoreConfig:"group/getCoreConfig"}),userterms_enabled(){return!!this.getCoreConfig&&this.getCoreConfig.conf.userterms}},methods:{openURL:D.Z,changeView(){"header"!=this.view?this.view="header":this.view="more"},async unregmember(){let e={account:this.getActiveGroup,name:"unregmember",data:{actor:this.getAccountName}};this.is_unregging=!0;let t=await this.$store.dispatch("proton/transact",{actions:[e],disable_signing_overlay:!0});t&&t.trxid&&(this.$store.commit("user/setIsMember",!1),this.is_member=!1),this.is_unregging=!1},async delprofile(){let e={account:this.getActiveGroup,name:"delprofile",data:{actor:this.getAccountName}};this.is_clearing_profile=!0;let t=await this.$store.dispatch("proton/transact",{actions:[e],disable_signing_overlay:!0});t&&t.trxid&&this.$store.commit("user/delProfile",this.getAccountName),this.is_clearing_profile=!1},async signuserterms(e=!0){let t={account:this.getActiveGroup,name:"signuserterm",data:{member:this.getAccountName,agree_terms:e}};this.is_signing_terms=!0;let o=await this.$store.dispatch("proton/transact",{actions:[t],disable_signing_overlay:!0});if(o&&o.trxid){let t=e?this.getLatestUserterms.id:0,o=Object.assign(this.getIsMember,{agreed_userterms_version:t});this.$store.commit("user/setIsMember",o)}this.is_signing_terms=!1}},watch:{account:{immediate:!0,handler:async function(e,t){e&&e!=t&&(this.is_member=await this.$store.dispatch("user/fetchIsMember",{accountname:this.account,vm:this}))}}}});var O=o(10151),R=o(25589),j=o(83414),z=o(52035),F=o(2350),H=o(5363),J=o(42670),Y=o(27011),K=o(46778),W=o(60677);const X=(0,A.Z)(G,[["render",x]]),ee=X;P()(G,"components",{QCard:O.Z,QCardSection:R.Z,QItem:j.Z,QItemSection:z.Z,QItemLabel:F.Z,QBtn:Q.Z,QTooltip:H.Z,QBtnDropdown:J.Z,QList:Y.Z,QDialog:K.Z}),P()(G,"directives",{ClosePopup:W.Z});const te={key:0},oe=["onClick"];function ae(e,t,o,n,r,l){const i=(0,a.resolveComponent)("q-btn"),c=(0,a.resolveComponent)("q-input");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.profile_data.links.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",te,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.profile_data.links,((t,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"text-link cursor-pointer"},[(0,a.createElementVNode)("span",{onClick:o=>e.openURL(t)},(0,a.toDisplayString)(t),9,oe),(0,a.createVNode)(i,{icon:"mdi-delete",onClick:t=>e.removeLink(o),dense:"",size:"sm",flat:"",color:"negative"},null,8,["onClick"])])))),128))])):(0,a.createCommentVNode)("",!0),e.getAccountName==e.profile_data.account?((0,a.openBlock)(),(0,a.createBlock)(c,{key:1,modelValue:e.newLink,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newLink=t),modelModifiers:{trim:!0},outlined:"",class:"q-mt-md","bottom-slots":"",hint:"",placeholder:"add new link"},{after:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{icon:"mdi-plus",onClick:e.addLink,color:"primary",round:""},null,8,["onClick"])])),_:1},8,["modelValue"])):(0,a.createCommentVNode)("",!0)])}const ne=(0,a.defineComponent)({name:"profileLinks",props:{account:{type:String,default:""},profile_data:{type:Object,default:()=>({})}},components:{},data(){return{newLink:""}},methods:{openURL:D.Z,addLink(){!0===(0,Z.jv)(this.newLink)&&this.profile_data.links.push(this.newLink)},removeLink(e){this.profile_data.links.splice(e,1)}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup"})}}),re=(0,A.Z)(ne,[["render",ae]]),le=re;P()(ne,"components",{QBtn:Q.Z,QInput:E.Z});const ie={key:0};function ce(e,t,o,n,r,l){return e.profile_data.files.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",ie,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.profile_data.files,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t})))),128)),(0,a.createElementVNode)("pre",null,(0,a.toDisplayString)(e.profile_data.profile.files),1)])):(0,a.createCommentVNode)("",!0)}function se(e,t,o,n,r,l){return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,"My component")}const de={data(){return{}}},me=(0,A.Z)(de,[["render",se]]),pe=me,ue=(0,a.defineComponent)({name:"profileFiles",components:{},props:{account:{type:String,default:""},profile_data:{type:Object,default:()=>({})}},components:{fileLink:pe},data(){return{}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup"})}}),ge=(0,A.Z)(ue,[["render",ce]]),he=ge,fe={key:0},ve={class:"q-mb-xs row justify-end"},_e={class:"absolute-bottom text-subtitle1 text-center"},Ce=(0,a.createElementVNode)("div",{class:"absolute-full flex flex-center bg-negative text-white"}," Cannot load image ",-1),ye=(0,a.createElementVNode)("div",{class:"absolute-full flex flex-center bg-negative text-white"}," Cannot load image ",-1);function ke(e,t,o,n,r,l){const i=(0,a.resolveComponent)("q-tooltip"),c=(0,a.resolveComponent)("q-btn"),s=(0,a.resolveComponent)("q-video"),d=(0,a.resolveComponent)("q-img"),m=(0,a.resolveComponent)("q-carousel-slide"),p=(0,a.resolveComponent)("q-carousel"),u=(0,a.resolveComponent)("new-image");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.profile_data.gallery?((0,a.openBlock)(),(0,a.createElementBlock)("div",fe,[(0,a.createElementVNode)("div",ve,[(0,a.createVNode)(c,{dense:"",flat:"",icon:"carousel"==e.mode?"mdi-view-carousel":"mdi-grid",onClick:t[0]||(t[0]=t=>"carousel"==e.mode?e.mode="grid":e.mode="carousel"),color:"primary"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{class:"bg-primary",delay:500,anchor:"center left",self:"center right"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)("carousel"==e.mode?"switch to grid mode":"switch carousel mode"),1)])),_:1})])),_:1},8,["icon"])]),"carousel"==e.mode?((0,a.openBlock)(),(0,a.createBlock)(p,{key:0,modelValue:e.slide,"onUpdate:modelValue":t[1]||(t[1]=t=>e.slide=t),"transition-prev":"slide-right","transition-next":"slide-left",swipeable:"",animated:"","control-color":"primary",navigation:"",arrows:"",height:"350px"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.profile_data.gallery,((t,o)=>((0,a.openBlock)(),(0,a.createBlock)(m,{key:o,name:o,class:"column no-wrap"},{default:(0,a.withCtx)((()=>[!0===e.isYouTubeUrl(t.url)?((0,a.openBlock)(),(0,a.createBlock)(s,{key:0,class:"absolute-full",src:t.url},null,8,["src"])):((0,a.openBlock)(),(0,a.createBlock)(d,{key:1,class:"rounded-borders col-6 full-height",contain:"","spinner-color":"primary",src:t.url},{error:(0,a.withCtx)((()=>[Ce])),default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",_e,(0,a.toDisplayString)(t.caption),1)])),_:2},1032,["src"]))])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])):"grid"==e.mode?((0,a.openBlock)(),(0,a.createBlock)(a.TransitionGroup,{key:1,class:"q-gutter-md row items-start",appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"out-in",tag:"div"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.profile_data.gallery,((t,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t.url+o,class:"relative-position",style:{height:"120px",width:"220px"}},[!0===e.isYouTubeUrl(t.url)?((0,a.openBlock)(),(0,a.createBlock)(s,{key:0,src:t.url,style:{"object-fit":"cover",height:"100%"}},null,8,["src"])):((0,a.openBlock)(),(0,a.createBlock)(d,{key:1,src:t.url,"spinner-color":"primary",style:{"object-fit":"contain",height:"120px",width:"220px",cursor:"pointer"},onClick:t=>{e.slide=o,e.mode="carousel"}},{error:(0,a.withCtx)((()=>[ye])),_:2},1032,["src","onClick"])),e.getAccountName==e.profile_data.account?((0,a.openBlock)(),(0,a.createBlock)(c,{key:2,icon:"mdi-delete",color:"negative",size:"sm",round:"",class:"absolute-top-right",onClick:t=>e.removeImage(o)},null,8,["onClick"])):(0,a.createCommentVNode)("",!0)])))),128))])),_:1})):(0,a.createCommentVNode)("",!0)])):(0,a.createCommentVNode)("",!0),e.getAccountName==e.profile_data.account?((0,a.openBlock)(),(0,a.createBlock)(u,{key:1,class:"q-mt-md",onNewImage:e.addImage},null,8,["onNewImage"])):(0,a.createCommentVNode)("",!0)])}const we=(0,a.createElementVNode)("div",{class:"absolute-full flex flex-center bg-negative text-white"},"x",-1),Ne={key:1,style:{width:"37px",height:"25px"},class:"row items-center justify-center border-primary text-caption"};function Ve(e,t,o,n,r,l){const i=(0,a.resolveComponent)("q-img"),c=(0,a.resolveComponent)("q-icon"),s=(0,a.resolveComponent)("q-btn"),d=(0,a.resolveComponent)("q-input");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(d,{modelValue:e.newImage,"onUpdate:modelValue":t[3]||(t[3]=t=>e.newImage=t),outlined:"",class:"q-mb-md","bottom-slots":"",hint:"",onInput:e.setNewImage,placeholder:"new image url"},{prepend:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[e.isValidUrlMutated?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,src:e.newImage,contain:"",style:{width:"40px","max-height":"25px"},onLoad:t[0]||(t[0]=t=>e.image_loaded=!0),onError:t[1]||(t[1]=t=>e.image_loaded=!1)},{error:(0,a.withCtx)((()=>[we])),_:1},8,["src"])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ne,[(0,a.createVNode)(c,{name:"mdi-plus"})]))])])),after:(0,a.withCtx)((()=>[(0,a.createVNode)(s,{icon:"mdi-plus",onClick:t[2]||(t[2]=t=>{e.$emit("newImage",e.newImage),e.image_loaded=!1,e.newImage=""}),color:"primary",round:"",disabled:!e.image_loaded},null,8,["disabled"])])),_:1},8,["modelValue","onInput"])])}const xe=(0,a.defineComponent)({name:"newImage",data(){return{newImage:"",image_loaded:!1}},computed:{isValidUrlMutated(){return!0===(0,Z.jv)(this.newImage)}},methods:{isValidUrl:Z.jv,setNewImage(e){e||(this.image_loaded=!1),this.newImage=e.trim()}}});var Be=o(24152);const be=(0,A.Z)(xe,[["render",Ve]]),Ze=be;P()(xe,"components",{QInput:E.Z,QImg:Be.Z,QIcon:I.Z,QBtn:Q.Z});const qe=(0,a.defineComponent)({name:"profileGallery",props:{account:{type:String,default:""},profile_data:{type:Object,default:()=>({})}},components:{newImage:Ze},data(){return{slide:0,mode:"grid"}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup"})},methods:{isYouTubeUrl:Z.yk,addImage(e){let t={url:e.trim()};this.profile_data.gallery.push(t)},removeImage(e){this.profile_data.gallery.splice(e,1)}}});var Ae=o(31277),Ee=o(34593),Ie=o(1419);const Qe=(0,A.Z)(qe,[["render",ke]]),Se=Qe;function Pe(e,t,o,n,r,l){const i=(0,a.resolveComponent)("q-input");return(0,a.openBlock)(),(0,a.createBlock)(i,{modelValue:e.profile_data.text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.profile_data.text=t),autogrow:"",type:"textarea"},null,8,["modelValue"])}P()(qe,"components",{QBtn:Q.Z,QTooltip:H.Z,QCarousel:Ae.Z,QCarouselSlide:Ee.Z,QVideo:Ie.Z,QImg:Be.Z});const Ue=(0,a.defineComponent)({name:"textEdit",props:{account:{type:String,default:""},profile_data:{type:Object,default:()=>({})}},data(){return{}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup",getMyOldProfile:"group/getMyOldProfile"})}}),Le=(0,A.Z)(Ue,[["render",Pe]]),Te=Le;function Me(e,t,o,n,r,l){const i=(0,a.resolveComponent)("my-payment"),c=(0,a.resolveComponent)("no-items"),s=(0,a.resolveComponent)("q-list");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(s,{class:"primary-hover-list no-padding",separator:""},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.payments,(e=>((0,a.openBlock)(),(0,a.createBlock)(i,{key:e.pay_id,payment:e},null,8,["payment"])))),128)),e.payments.length?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createBlock)(c,{key:0,text:"No payments"}))])),_:1})])}P()(Ue,"components",{QInput:E.Z});const $e={class:"row justify-between"};function De(e,t,o,n,r,l){const i=(0,a.resolveComponent)("q-item-label"),c=(0,a.resolveComponent)("q-badge"),s=(0,a.resolveComponent)("q-item-section"),d=(0,a.resolveComponent)("q-btn"),m=(0,a.resolveComponent)("q-separator"),p=(0,a.resolveComponent)("payment-details"),u=(0,a.resolveComponent)("q-expansion-item");return e.payment&&e.show?((0,a.openBlock)(),(0,a.createBlock)(u,{key:0,clickable:""},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(s,{side:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.payment.payroll_tag),1)])),_:1}),(0,a.createVNode)(i,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(c,null,{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.payment.pay_id),1)])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(s,null,{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",$e,[(0,a.createVNode)(i,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.payment.memo),1)])),_:1}),(0,a.createVNode)(i,{caption:""},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.payment.amount),1)])),_:1})])])),_:1}),(0,a.createVNode)(s,{side:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{label:"claim",onClick:t[0]||(t[0]=t=>e.claimPayment(e.payment.pay_id)),color:"primary",loading:e.is_claiming},null,8,["loading"])])),_:1})])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(m),(0,a.createVNode)(p,{payment:e.payment},null,8,["payment"])])),_:1})):(0,a.createCommentVNode)("",!0)}var Ge=o(6781);const Oe=(0,a.defineComponent)({name:"myPayment",props:{payment:{}},components:{paymentDetails:Ge.Z},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getModuleByName:"group/getModuleByName"})},data(){return{is_claiming:!1,show:!0}},methods:{async claimPayment(e){this.is_claiming=!0;let t={account:this.getModuleByName("payroll").slave_permission.actor,name:"pay",data:{pay_id:e}},o=await this.$store.dispatch("proton/transact",{actions:[t],disable_signing_overlay:!0});o&&o.trxid&&(this.show=!1,setTimeout((()=>{this.$store.dispatch("payroll/fetchUserPayments",{contract:this.getModuleByName("payroll").slave_permission.actor,account:this.getAccountName,vm:this})}),2e3)),this.is_claiming=!1}}});var Re=o(60429),je=o(69721),ze=o(65869);const Fe=(0,A.Z)(Oe,[["render",De]]),He=Fe;P()(Oe,"components",{QExpansionItem:Re.Z,QItemSection:z.Z,QItemLabel:F.Z,QBadge:je.Z,QBtn:Q.Z,QSeparator:ze.Z});var Je=o(3229);const Ye=(0,a.defineComponent)({name:"myPayments",props:{payments:{type:Array,default:()=>[]}},components:{myPayment:He,noItems:Je.Z},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getModuleByName:"group/getModuleByName"})},data(){return{}},methods:{}}),Ke=(0,A.Z)(Ye,[["render",Me]]),We=Ke;P()(Ye,"components",{QList:Y.Z});const Xe={key:0,class:"row"},et=["onClick"],tt={key:1},ot={class:"row justify-end"};function at(e,t,o,n,r,l){const i=(0,a.resolveComponent)("profile-pic"),c=(0,a.resolveComponent)("q-tooltip"),s=(0,a.resolveComponent)("date-string"),d=(0,a.resolveComponent)("q-btn"),m=(0,a.resolveComponent)("q-card-section"),p=(0,a.resolveComponent)("q-card");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(a.Transition,{appear:"","enter-active-class":"animated zoomIn"},{default:(0,a.withCtx)((()=>[e.votes.votes?((0,a.openBlock)(),(0,a.createBlock)(p,{key:0},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,null,{default:(0,a.withCtx)((()=>[e.votes.votes.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Xe,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.votes.votes,(t=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"q-mr-sm cursor-pointer",onClick:o=>e.goToProfile(t)},[(0,a.createVNode)(i,{account:t,size:40,class:"shadow-5"},null,8,["account"]),(0,a.createVNode)(c,{class:"bg-primary",delay:500},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t),1)])),_:2},1024)],8,et)))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",tt,"withdrew all votes")),(0,a.createElementVNode)("div",ot,[(0,a.createVNode)(s,{date:e.votes.last_voted,prepend:"Last voted: "},null,8,["date"]),(0,a.createVNode)(d,{icon:"mdi-vote",size:"xs",flat:"",dense:"",round:"",color:"primary",to:`/members/${this.$route.params.groupname}/elections`},null,8,["to"])])])),_:1})])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})])}var nt=o(40019);const rt=(0,a.defineComponent)({name:"displayVotes",components:{profilePic:B.Z,dateString:T.Z},props:{votes:{}},data(){return{}},methods:{goToProfile(e){nt.log(`go to profile ${e}`),this.$router.push(`/members/${this.$route.params.groupname}/profile/${e}`).catch((e=>{}))}}}),lt=(0,A.Z)(rt,[["render",at]]),it=lt;P()(rt,"components",{QCard:O.Z,QCardSection:R.Z,QTooltip:H.Z,QBtn:Q.Z});var ct=o(77242);function st(e,t,o,n,r,l){return e.component?((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(e.component),{key:0,class:(0,a.normalizeClass)(e.do_hashes_match?"":"hashes_not_match")},null,8,["class"])):(0,a.createCommentVNode)("",!0)}var dt=o(16336),mt=o(40019);const pt=(0,a.defineComponent)({name:"componentLoader",props:{comp_id:{type:Number,default:0}},data(){return{component:!1,remote_hash:!1}},computed:{...(0,g.Se)({getComponentRegistry:"app/getComponentRegistry"}),do_hashes_match(){return!this.component||!this.remote_hash||this.getComponentRegistry[this.comp_id].hash[0]==this.remote_hash}},methods:{async loadComponent(){httpVueLoader.httpRequest=async e=>{let t=await this.$axios.get(e).catch((e=>e.status));if(t&&t.data&&(this.remote_hash=(0,dt.JQ)(t.data),mt.log(this.remote_hash),this.remote_hash==this.getComponentRegistry[this.comp_id].hash[0]))return t.data};let e=this.getComponentRegistry[this.comp_id].src[0];try{this.component=await httpVueLoader(e)}catch(t){mt.log("error loading external component")}}},async mounted(){this.loadComponent()}}),ut=(0,A.Z)(pt,[["render",st]]),gt=ut,ht=(0,a.defineComponent)({name:"profile",components:{profileHeader:ee,profileText:h.Z,profileLinks:le,profileFiles:he,profileGallery:Se,textEdit:Te,dateString:T.Z,myPayments:We,displayVotes:it,componentLoader:gt},data(){return{profile_data:null,account:null,edit_tab_show:!1,active_tab:"textview",is_transacting:!1,userVotes:[],my_payments:[]}},computed:{...(0,g.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup",getIsGuardian:"group/getIsGuardian",getMyOldProfile:"group/getMyOldProfile",getElectionsContract:"elections/getElectionsContract",getModuleByName:"group/getModuleByName"}),isProfileChanged(){if(this.getMyOldProfile&&this.profile_data&&this.profile_data.account==this.getMyOldProfile.account)return(0,ct.diff)(this.getMyOldProfile,this.profile_data)},mutated_load_my_payments(){let e=this.getModuleByName("payroll");return this.getAccountName==this.account&&e}},methods:{async updateProfileDataKey(){this.is_transacting=!0;let e=[];if(!this.isProfileChanged)return;for(let o=0;o<this.isProfileChanged.length;o++){const t=this.isProfileChanged[o].path[0];let a={account:this.getActiveGroup,name:"updatprofile",data:{actor:this.getAccountName,key:t,data:"text"==t?this.profile_data[t]:JSON.stringify(this.profile_data[t])}};e.push(a)}let t=await this.$store.dispatch("proton/transact",{actions:e,disable_signing_overlay:!0});t&&t.trxid&&(this.$store.commit("group/updateProfileTimestamp",{account:this.getAccountName,timestamp:t.block_time}),this.$store.commit("group/setMyOldProfile",JSON.parse(JSON.stringify(this.profile_data)))),this.is_transacting=!1},async getUserVotes(){this.getElectionsContract&&(this.userVotes=await this.$store.dispatch("elections/fetchUserVotes",{voter:this.account,vm:this}))}},watch:{"$route.params.accountname":{immediate:!0,async handler(e,t){e&&e!=t&&(this.account=e,this.profile_data=await this.$store.dispatch("group/fetchProfile",{accountname:this.account,vm:this}),this.active_tab="textview",this.getUserVotes())}},mutated_load_my_payments:{immediate:!0,handler:async function(e,t){e&&e!=t&&(this.my_payments=await this.$store.dispatch("payroll/fetchUserPayments",{contract:this.getModuleByName("payroll").slave_permission.actor,account:this.account,vm:this}))}}}});var ft=o(24379),vt=o(57547),_t=o(58408),Ct=o(5906),yt=o(86602);const kt=(0,A.Z)(ht,[["render",u]]),wt=kt;P()(ht,"components",{QPage:ft.Z,QCard:O.Z,QCardSection:R.Z,QTabs:vt.Z,QTab:_t.Z,QIcon:I.Z,QBtn:Q.Z,QTooltip:H.Z,QSeparator:ze.Z,QTabPanels:Ct.Z,QTabPanel:yt.Z})}}]);