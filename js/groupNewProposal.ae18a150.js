"use strict";(self["webpackChunkthedaoscapefrontend"]=self["webpackChunkthedaoscapefrontend"]||[]).push([[209],{96538:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Ye});var n=o(34182);function a(e,t,o,a,i,l){const c=(0,n.resolveComponent)("page-header"),r=(0,n.resolveComponent)("proposeBucket"),s=(0,n.resolveComponent)("q-tab"),d=(0,n.resolveComponent)("q-tabs"),u=(0,n.resolveComponent)("q-separator"),m=(0,n.resolveComponent)("find-account"),p=(0,n.resolveComponent)("list-actions"),h=(0,n.resolveComponent)("q-tab-panel"),k=(0,n.resolveComponent)("q-btn"),v=(0,n.resolveComponent)("action-fields"),_=(0,n.resolveComponent)("q-tab-panels"),b=(0,n.resolveComponent)("q-page");return(0,n.openBlock)(),(0,n.createBlock)(b,{padding:"",class:"constrain-page-width"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{title:"New Proposal"}),(0,n.createVNode)(r),(0,n.createVNode)(d,{modelValue:e.active_tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.active_tab=t),class:"text-primary q-mt-md",dense:"",align:"left"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(s,{label:"Advanced",name:"advanced"})])),_:1},8,["modelValue"]),(0,n.createVNode)(u,{class:"q-mb-md"}),(0,n.createVNode)(_,{modelValue:e.advanced_slide,"onUpdate:modelValue":t[1]||(t[1]=t=>e.advanced_slide=t),animated:"","transition-prev":"scale","transition-next":"scale",class:"bg-transparent"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(h,{name:"action_selection",class:"no-padding overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(m,{value:e.selected_contract,onInputval:e.handleInput},null,8,["value","onInputval"]),e.selected_contract?((0,n.openBlock)(),(0,n.createBlock)(p,{key:0,ref:"listactions",action_name:e.selected_action_name,contract:e.selected_contract,onActionSelect:e.showActionFields,class:"q-mt-md"},null,8,["action_name","contract","onActionSelect"])):(0,n.createCommentVNode)("",!0)])),_:1}),(0,n.createVNode)(h,{name:"action_fields",class:"no-padding overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(k,{icon:"close",round:"",flat:"",class:"absolute-top-right",color:"primary",onClick:e.goBackToActionSelection},null,8,["onClick"]),(0,n.createVNode)(v,{fields:e.active_action_fields},null,8,["fields"])])),_:1})])),_:1},8,["modelValue"])])),_:1})}o(10071),o(66016);var i=o(10741),l=o(33314);const c={class:"relative-position",style:{height:"70px",width:"70px"}},r=(0,n.createElementVNode)("div",{class:"text-weight-light text-h6 text-white"},"Action Bucket",-1),s=(0,n.createTextVNode)("The bucket holds multiple actions to propose at once."),d=(0,n.createTextVNode)("View raw"),u=(0,n.createTextVNode)("Delete all"),m=(0,n.createTextVNode)("Save to file"),p=(0,n.createTextVNode)("Bucket is empty"),h={key:0,class:"row items-center justify-between q-pa-md bg-secondary"},k={key:0,class:"row no-wrap q-pl-xs"},v=(0,n.createElementVNode)("div",{class:"text-caption text-grey-5 q-pt-sm q-pl-xs"},[(0,n.createElementVNode)("i",null,"drag to order")],-1),_={class:"q-col-gutter-md"},b=(0,n.createTextVNode)("                "),f={class:"row items-center justify-between"},w={style:{height:"200px"},class:"column justify-center items-center"},g=(0,n.createElementVNode)("div",{class:"text-grey-5"},"Waiting for signature",-1),C={style:{height:"200px"},class:"column justify-center items-center"},V=(0,n.createElementVNode)("div",{class:"text-grey-5"},"Transaction successful",-1),x={style:{height:"200px"},class:"column justify-center items-center"},N=(0,n.createElementVNode)("div",{class:"text-grey-5"},"Transaction error",-1),y=["innerHTML"];function B(e,t,o,a,i,l){const B=(0,n.resolveComponent)("bucket-svg"),q=(0,n.resolveComponent)("number-pop-animation"),A=(0,n.resolveComponent)("q-item-section"),Z=(0,n.resolveComponent)("q-item-label"),E=(0,n.resolveComponent)("q-item"),S=(0,n.resolveComponent)("q-list"),T=(0,n.resolveComponent)("q-menu"),Q=(0,n.resolveComponent)("q-icon"),z=(0,n.resolveComponent)("q-separator"),I=(0,n.resolveComponent)("bucket-item"),F=(0,n.resolveComponent)("q-space"),L=(0,n.resolveComponent)("q-btn"),$=(0,n.resolveComponent)("q-tab-panel"),D=(0,n.resolveComponent)("q-input"),U=(0,n.resolveComponent)("q-markdown"),O=(0,n.resolveComponent)("q-spinner"),P=(0,n.resolveComponent)("q-scroll-area"),R=(0,n.resolveComponent)("q-tab-panels"),j=(0,n.resolveComponent)("q-expansion-item"),G=(0,n.resolveComponent)("q-card"),M=(0,n.resolveDirective)("close-popup");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(G,{class:"overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(j,{class:"bg-secondary",modelValue:e.bucket_opened,"onUpdate:modelValue":t[15]||(t[15]=t=>e.bucket_opened=t),"switch-toggle-side":!1,"expand-icon-class":"display-none",onHide:t[16]||(t[16]=t=>"view_raw_bucket"==e.bucket_view?e.bucket_view="bucket_list":"")},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{avatar:""},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",c,[(0,n.createVNode)(B,{color:e.thumbStyle.backgroundColor,size:70},null,8,["color"]),(0,n.createVNode)(q,{input_value:e.getActionBucket.length,class:"absolute",style:{top:"35px",left:"21px"}},null,8,["input_value"])])])),_:1}),(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[r,(0,n.createVNode)(Z,{caption:"",class:"gt-xs text-grey-6"},{default:(0,n.withCtx)((()=>[s])),_:1})])),_:1}),(0,n.createVNode)(A,{side:"",onClick:t[4]||(t[4]=(0,n.withModifiers)((()=>{}),["stop"]))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Q,{name:e.bucket_menu_visible?"menu_open":"menu",class:"cursor-pointer"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(T,{onBeforeShow:t[2]||(t[2]=t=>e.bucket_menu_visible=!0),onHide:t[3]||(t[3]=t=>e.bucket_menu_visible=!1)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(S,{dense:"",style:{"min-width":"100px"},class:"primary-hover-list"},{default:(0,n.withCtx)((()=>[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(E,{clickable:"",onClick:t[0]||(t[0]=t=>e.bucket_opened=!e.bucket_opened)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.bucket_opened?"Close":"Open"),1)])),_:1})])),_:1})),[[M]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(E,{disabled:!e.getActionBucket.length,clickable:"",onClick:e.handleViewRawClick},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[d])),_:1})])),_:1},8,["disabled","onClick"])),[[M]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(E,{disabled:!e.getActionBucket.length,clickable:"",onClick:t[1]||(t[1]=t=>e.$store.commit("bucket/setActionBucket",[]))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[u])),_:1})])),_:1},8,["disabled"])),[[M]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(E,{disabled:!e.getActionBucket.length,clickable:"",onClick:e.exportBucket},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[m])),_:1})])),_:1},8,["disabled","onClick"])),[[M]])])),_:1})])),_:1})])),_:1},8,["name"])])),_:1})])),default:(0,n.withCtx)((()=>[(0,n.createVNode)(z),(0,n.createVNode)(R,{modelValue:e.bucket_view,"onUpdate:modelValue":t[14]||(t[14]=t=>e.bucket_view=t),animated:"","transition-prev":"scale","transition-next":"scale"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)($,{name:"bucket_list",class:"overflow-hidden no-padding"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",null,[(0,n.createVNode)(S,{class:"primary-hover-list",separator:""},{default:(0,n.withCtx)((()=>[e.getActionBucket.length?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createBlock)(E,{key:0},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Z,null,{default:(0,n.withCtx)((()=>[p])),_:1})])),_:1})])),_:1})),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.getActionBucket,(e=>((0,n.openBlock)(),(0,n.createBlock)(E,null,{default:(0,n.withCtx)((()=>[((0,n.openBlock)(),(0,n.createBlock)(I,{key:e.unique_id,action:e},null,8,["action"]))])),_:2},1024)))),256))])),_:1}),(0,n.createVNode)(n.Transition,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:(0,n.withCtx)((()=>[e.getActionBucket.length?((0,n.openBlock)(),(0,n.createElementBlock)("div",h,[e.getActionBucket.length>1?((0,n.openBlock)(),(0,n.createElementBlock)("div",k,[(0,n.createVNode)(Q,{name:"mdi-subdirectory-arrow-left",color:"primary",class:"rotate-90",size:"24px"}),v])):((0,n.openBlock)(),(0,n.createBlock)(F,{key:1})),(0,n.createVNode)(L,{disabled:!e.getActionBucket.length,label:"next",onClick:t[5]||(t[5]=t=>e.bucket_view="bucket_meta"),color:"primary",size:"md"},null,8,["disabled"])])):(0,n.createCommentVNode)("",!0)])),_:1})])])),_:1}),(0,n.createVNode)($,{name:"bucket_meta",class:"overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",_,[(0,n.createVNode)(D,{label:"Title",modelValue:e.propose_title,"onUpdate:modelValue":t[6]||(t[6]=t=>e.propose_title=t),outlined:""},null,8,["modelValue"]),(0,n.createElementVNode)("div",null,[(0,n.createElementVNode)("div",{class:"cursor-pointer text-caption",onClick:t[7]||(t[7]=t=>e.preview_description=!e.preview_description)}," ("+(0,n.toDisplayString)(e.preview_description?"Edit":"Preview")+") ",1),e.preview_description?((0,n.openBlock)(),(0,n.createBlock)(U,{key:0,style:{"min-height":"145px"},class:"text-weight-light",src:e.propose_description,"no-abbreviation":!1},{default:(0,n.withCtx)((()=>[b])),_:1},8,["src"])):((0,n.openBlock)(),(0,n.createBlock)(D,{key:1,label:"Description",placeholder:"markdown supported",modelValue:e.propose_description,"onUpdate:modelValue":t[8]||(t[8]=t=>e.propose_description=t),type:"textarea",outlined:""},null,8,["modelValue"]))]),(0,n.createElementVNode)("div",f,[(0,n.createVNode)(L,{flat:"",label:"back",onClick:t[9]||(t[9]=t=>e.bucket_view="bucket_list"),color:"primary",size:"md"}),(0,n.createVNode)(L,{disabled:!e.propose_title||!e.propose_description,label:"propose",onClick:e.propose,color:"primary",size:"md"},null,8,["disabled","onClick"])])])])),_:1}),(0,n.createVNode)($,{name:"request_signature",class:"overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",w,[(0,n.createVNode)(O,{size:"36px",color:"primary",onClick:t[10]||(t[10]=t=>e.bucket_view="bucket_meta"),class:"cursor-pointer"}),g])])),_:1}),(0,n.createVNode)($,{name:"trx_success",class:"overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",C,[(0,n.createVNode)(Q,{name:"mdi-check-circle-outline",size:"48px",color:"positive",onClick:t[11]||(t[11]=t=>e.bucket_view="bucket_meta"),class:"cursor-pointer"}),V])])),_:1}),(0,n.createVNode)($,{name:"trx_error",class:"overflow-hidden"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",x,[(0,n.createVNode)(Q,{name:"mdi-alert-circle-outline",size:"48px",color:"negative",onClick:t[12]||(t[12]=t=>e.bucket_view="bucket_meta"),class:"cursor-pointer"}),N])])),_:1}),(0,n.createVNode)($,{name:"view_raw_bucket",class:"overflow-hidden text-secondary"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(L,{icon:"close",unelevated:"",style:{"z-index":"99"},round:"",class:"absolute-top-right q-ma-md",onClick:t[13]||(t[13]=t=>e.bucket_view="bucket_list"),size:"sm",color:"secondary"}),(0,n.createVNode)(P,{visible:!0,"thumb-style":e.thumbStyle,style:{height:"250px",width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",{innerHTML:e.getRawBucketContent},null,8,y)])),_:1},8,["thumb-style"])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])}var q=o(49905),A=o(40470),Z=o.n(A),E=o(90237),S=o(93077);const T={class:"row items-center"},Q=(0,n.createTextVNode)("Delete"),z=(0,n.createTextVNode)("Action data"),I=(0,n.createTextVNode)("Authorization");function F(e,t,o,a,i,l){const c=(0,n.resolveComponent)("q-item-label"),r=(0,n.resolveComponent)("q-item-section"),s=(0,n.resolveComponent)("threshold-badge"),d=(0,n.resolveComponent)("q-tooltip"),u=(0,n.resolveComponent)("q-btn"),m=(0,n.resolveComponent)("q-separator"),p=(0,n.resolveComponent)("q-item"),h=(0,n.resolveComponent)("authorization-display"),k=(0,n.resolveComponent)("q-card-section"),v=(0,n.resolveComponent)("q-card"),_=(0,n.resolveComponent)("q-expansion-item");return(0,n.openBlock)(),(0,n.createBlock)(_,{group:"bucketitem",clickable:"",class:"cursor-default",style:{"border-bottom":"1px solid grey"}},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(r,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.action.account)+" > "+(0,n.toDisplayString)(e.action.name),1)])),_:1})])),_:1}),(0,n.createVNode)(r,{side:""},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",T,[(0,n.createVNode)(s,{contract:e.action.account,action_name:e.action.name,class:"q-mr-sm"},null,8,["contract","action_name"]),(0,n.createVNode)(u,{icon:"remove",unelevated:"",dense:"",size:"sm",color:"negative",onClick:t[0]||(t[0]=t=>e.$store.commit("bucket/removeFromActionBucketByIndex",e.key))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{delay:400,class:"bg-secondary"},{default:(0,n.withCtx)((()=>[Q])),_:1})])),_:1})])])),_:1})])),default:(0,n.withCtx)((()=>[(0,n.createVNode)(m),(0,n.createVNode)(v,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(k,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(p,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,null,{default:(0,n.withCtx)((()=>[z])),_:1}),(0,n.createVNode)(c,{caption:""},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.action.data),1)])),_:1})])),_:1})])),_:1}),(0,n.createVNode)(p,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,null,{default:(0,n.withCtx)((()=>[I])),_:1}),(0,n.createVNode)(c,{caption:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(h,{action:e.action,edit:!0},null,8,["action"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}const L=(0,n.createTextVNode)("warning, no authorization set "),$={key:0},D={class:"q-mt-md row items-center justify-between no-wrap"},U=(0,n.createTextVNode)(" @ ");function O(e,t,o,a,i,l){const c=(0,n.resolveComponent)("q-btn"),r=(0,n.resolveComponent)("q-badge"),s=(0,n.resolveComponent)("q-icon"),d=(0,n.resolveComponent)("q-input");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(n.TransitionGroup,{"enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"in-out",class:"row q-gutter-xs items-center",tag:"div"},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.action.authorization,((t,o)=>((0,n.openBlock)(),(0,n.createBlock)(r,{key:t.actor+t.permission},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(`${t.actor}@${t.permission}`)+" ",1),e.edit?((0,n.openBlock)(),(0,n.createBlock)(c,{key:0,onClick:t=>e.remove(o),icon:"mdi-close",size:"xs",round:"",dense:"",color:"secondary",class:"no-shadow q-ml-xs"},null,8,["onClick"])):(0,n.createCommentVNode)("",!0)])),_:2},1024)))),128)),0==e.action.authorization.length?((0,n.openBlock)(),(0,n.createBlock)(r,{color:"warning",key:"warning"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(s,{name:"mdi-alert"}),L])),_:1})):(0,n.createCommentVNode)("",!0)])),_:1}),e.edit?((0,n.openBlock)(),(0,n.createElementBlock)("div",$,[(0,n.createElementVNode)("div",D,[(0,n.createVNode)(d,{dense:"",style:{"min-width":"200px"},class:"q-mr-xs",ref:"actor",modelValue:e.new_actor,"onUpdate:modelValue":t[0]||(t[0]=t=>e.new_actor=t),label:"Actor",outlined:"",maxlength:"12",debounce:500,"bottom-slots":"",placeholder:"name of the account","no-error-icon":"",rules:[e=>!!e||"* Required",e.isValidAccountName,e.isExistingAccountNameWrapper]},null,8,["modelValue","rules"]),(0,n.createVNode)(d,{dense:"",style:{width:"100%"},ref:"permission",modelValue:e.new_permission,"onUpdate:modelValue":t[1]||(t[1]=t=>e.new_permission=t),label:"Permission",outlined:"","bottom-slots":"",placeholder:"permission to use","no-error-icon":"",rules:[e=>!!e||"* Required",e.isValidAccountName]},{prepend:(0,n.withCtx)((()=>[U])),after:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{icon:"mdi-plus",onClick:e.add,dense:"",round:"",color:"primary"},null,8,["onClick"])])),_:1},8,["modelValue","rules"])])])):(0,n.createCommentVNode)("",!0)])}var P=o(47592);const R=(0,n.defineComponent)({name:"authorizationDisplay",props:{action:{type:Object,default:()=>({})},edit:{type:Boolean,default:!1}},data(){return{new_actor:"",new_permission:""}},methods:{isValidAccountName:P.ZF,isExistingAccountName:P.oO,async isExistingAccountNameWrapper(e){return await(0,P.oO)({value:e,vm:this})},add(){this.$refs.actor.validate(),this.$refs.permission.validate(),this.$refs.actor.hasError||this.$refs.permission.hasError||(this.action.authorization.push({actor:this.new_actor,permission:this.new_permission}),this.new_actor="",this.new_permission="")},remove(e){this.action.authorization.splice(e,1)}}});var j=o(74260),G=o(69721),M=o(2165),J=o(24554),H=o(64689),W=o(7518),K=o.n(W);const X=(0,j.Z)(R,[["render",O]]),Y=X;K()(R,"components",{QBadge:G.Z,QBtn:M.Z,QIcon:J.Z,QInput:H.Z});var ee=o(69917);const te=(0,n.defineComponent)({name:"bucketItem",components:{authorizationDisplay:Y,thresholdBadge:ee.Z},props:{action:{},key:"",i:0},data(){return{}}});var oe=o(60429),ne=o(52035),ae=o(2350),ie=o(5363),le=o(65869),ce=o(10151),re=o(25589),se=o(83414);const de=(0,j.Z)(te,[["render",F]]),ue=de;K()(te,"components",{QExpansionItem:oe.Z,QItemSection:ne.Z,QBadge:G.Z,QItemLabel:ae.Z,QBtn:M.Z,QTooltip:ie.Z,QSeparator:le.Z,QCard:ce.Z,QCardSection:re.Z,QItem:se.Z});var me=o(63139);const pe=o(42869)["default"],he=(0,n.defineComponent)({name:"proposeBucket",components:{draggable:Z(),numberPopAnimation:E.Z,bucketSvg:S.Z,bucketItem:ue},data(){return{preview_description:!1,bucket_opened:!1,bucket_view:"bucket_list",propose_title:"",propose_description:"",bucket_menu_visible:!1,raw_bucket_content:"",thumbStyle:{right:"-16px",borderRadius:"5px",backgroundColor:(0,q.Z)("primary"),width:"5px",opacity:.75}}},computed:{...(0,i.Se)({getActionBucket:"bucket/getActionBucket",getLinkedThresholdForContractAction:"group/getLinkedThresholdForContractAction"}),draggable_action_bucket:{get(){return this.getActionBucket},set(e){this.$store.commit("bucket/setActionBucket",e)}},getRawBucketContent(){const e=pe(this.clone_bucket());return e}},methods:{clone_bucket(){let e=JSON.parse(JSON.stringify(this.getActionBucket));return e.forEach((e=>{delete e.unique_id})),e},exportBucket(){if(0==this.getActionBucket.length)return;let e=this.clone_bucket(),t=new Blob([JSON.stringify(e,null,4)],{type:"text/plain;charset=utf-8"});(0,me.saveAs)(t,`action_bucket_${Date.now()}.json`)},handleViewRawClick(){if(!this.getActionBucket.length)return this.bucket_view="bucket_list",void(this.bucket_opened=!0);this.bucket_opened=!0,this.bucket_view="view_raw_bucket"},async propose(){this.bucket_view="request_signature";let e=JSON.parse(JSON.stringify(this.getActionBucket));e.forEach((e=>{e.data=e.hex,delete e.hex,delete e.unique_id}));let t=await this.$store.dispatch("group/propose",{data:{actions:e,description:this.propose_description,title:this.propose_title},vm:this});t&&t.trxid?(this.$store.commit("bucket/setActionBucket",[]),this.bucket_view="trx_success"):this.bucket_view="trx_error",setTimeout((()=>{this.bucket_view="bucket_list"}),1500)}}});var ke=o(20811),ve=o(27011),_e=o(5906),be=o(86602),fe=o(62025),we=o(6833),ge=o(47704),Ce=o(60677);const Ve=(0,j.Z)(he,[["render",B]]),xe=Ve;K()(he,"components",{QCard:ce.Z,QExpansionItem:oe.Z,QItemSection:ne.Z,QIcon:J.Z,QItemLabel:ae.Z,QMenu:ke.Z,QList:ve.Z,QItem:se.Z,QSeparator:le.Z,QTabPanels:_e.Z,QTabPanel:be.Z,QSpace:fe.Z,QBtn:M.Z,QInput:H.Z,QSpinner:we.Z,QScrollArea:ge.Z}),K()(he,"directives",{ClosePopup:Ce.Z});const Ne={key:0},ye={key:1,class:"row justify-center items-center",style:{height:"100px"}};function Be(e,t,o,a,i,l){const c=(0,n.resolveComponent)("q-icon"),r=(0,n.resolveComponent)("q-input"),s=(0,n.resolveComponent)("q-item-section"),d=(0,n.resolveComponent)("q-item-label"),u=(0,n.resolveComponent)("q-item"),m=(0,n.resolveComponent)("q-spinner");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[e.is_loading?((0,n.openBlock)(),(0,n.createElementBlock)("div",ye,[(0,n.createVNode)(m,{color:"primary",size:"48px"})])):((0,n.openBlock)(),(0,n.createElementBlock)("div",Ne,[e.abi_actions.length?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,placeholder:"Search Actions",outlined:"",modelValue:e.filter,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filter=t),modelModifiers:{trim:!0},class:"q-mb-md"},{prepend:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{name:"search",class:"cursor-pointer"})])),append:(0,n.withCtx)((()=>[(0,n.createVNode)(n.Transition,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",tag:"div"},{default:(0,n.withCtx)((()=>[e.filter.length?((0,n.openBlock)(),(0,n.createBlock)(c,{name:"close",key:"has_filter",onClick:t[0]||(t[0]=t=>e.filter=""),class:"cursor-pointer"})):(0,n.createCommentVNode)("",!0)])),_:1})])),_:1},8,["modelValue"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(n.TransitionGroup,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"in-out",class:"row q-col-gutter-xs",tag:"div"},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.getActionListWithFilter,(t=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:t.name,style:{width:"157px"}},[(0,n.createVNode)(u,{clickable:"",onClick:o=>e.handleActionClick(t),dense:"",class:"bg-primary cursor-pointer rounded-borders"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(s,{avatar:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{name:"check",color:"white"})])),_:1}),(0,n.createVNode)(s,{style:{"margin-left":"-22px"},class:"text-center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{class:"text-white text-uppercase",style:{"font-size":"12px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])))),128))])),_:1})]))])}var qe=o(40019);const Ae=(0,n.defineComponent)({name:"listActions",props:{contract:{type:String,default:""},action_name:{type:String,default:""}},data(){return{abi:"",abi_actions:[],selected_action:"",filter:"",is_loading:!1}},computed:{getActionListWithFilter(){return this.filter?(this.filter=this.filter.toLowerCase(),this.abi_actions.filter((e=>e.name.includes(this.filter)))):this.abi_actions}},methods:{async getActionsFromAbi(e){if(!e)return;this.is_loading=!0,this.abi="",this.abi_actions=[];let t=await this.$eos.api.rpc.get_abi(e);if(qe.log(t),!t||t.account_name!=e||!t.abi)return[];this.abi=t,this.abi_actions=t.abi.actions.map((e=>{let t={};return t.name=e.name,t.type=e.type,t.icon="http://raw.githubusercontent.com/EOS-Jungle-Testnet/icons/master/admin.png#9bf1cec664863bd6aaac0f814b235f8799fb02c850e9aa5da34e8a004bd6518e",t})),this.is_loading=!1},getStructForAction(e){let t=this.abi.abi.structs.find((t=>t.name==e.name||t.name==e.type));if(t)return t;alert(`struct not found for ${e.name}`)},handleActionClick(e){this.$emit("action-select",this.getStructForAction(e))}},watch:{contract:{handler:function(e){e&&this.getActionsFromAbi(e)},immediate:!0},action_name:{handler:async function(e,t){e&&e!=t&&(this.filter=e)},immediate:!0},abi_actions:{immediate:!1,handler:function(e,t){if(e!=t&&e.length){let e=window.location.search.substring(1),t=new URLSearchParams(e),o=t.get("action");if(o){let e=this.abi_actions.find((e=>e.name==o));e&&this.handleActionClick(e)}}}}}});var Ze=o(24152);const Ee=(0,j.Z)(Ae,[["render",Be]]),Se=Ee;K()(Ae,"components",{QInput:H.Z,QIcon:J.Z,QItem:se.Z,QItemSection:ne.Z,QImg:Ze.Z,QItemLabel:ae.Z,QSpinner:we.Z});var Te=o(1675);const Qe={class:"text-grey-7 text-h6 q-mb-md"},ze=(0,n.createElementVNode)("span",{class:"text-primary q-mx-xs"},">",-1),Ie={class:"row q-col-gutter-md",style:{"min-height":"50px"}},Fe={key:0},Le={key:1},$e={key:2},De={class:"row justify-between full-width items-center q-pb-xs"};function Ue(e,t,o,a,i,l){const c=(0,n.resolveComponent)("q-select"),r=(0,n.resolveComponent)("q-input"),s=(0,n.resolveComponent)("threshold-badge"),d=(0,n.resolveComponent)("q-btn");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createElementVNode)("div",Qe,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.fields.contract),1),ze,(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.fields.name),1)]),(0,n.createElementVNode)("div",Ie,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.action_fields.fields,(t=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:t.name,class:"col-xs-12 col-sm-6 col-md-4"},["bool"==t.type?((0,n.openBlock)(),(0,n.createElementBlock)("div",Fe,[(0,n.createVNode)(c,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,"bottom-slots":"",label:t.name,outlined:"",color:"primary","emit-value":"",options:[{value:!0,label:"true"},{value:!1,label:"false"}]},null,8,["modelValue","onUpdate:modelValue","label"])])):e.isNumberType(t.type)?((0,n.openBlock)(),(0,n.createElementBlock)("div",Le,[(0,n.createVNode)(r,{type:"number",outlined:"",color:"primary",label:t.name,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,placeholder:`${t.type}`,"bottom-slots":"",rules:[...e.getValidationRulesForType(t.type)]},null,8,["label","modelValue","onUpdate:modelValue","placeholder","rules"])])):((0,n.openBlock)(),(0,n.createElementBlock)("div",$e,[(0,n.createVNode)(r,{outlined:"",color:"primary",label:t.name,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,placeholder:`${t.type}`,"bottom-slots":"",rules:[...e.getValidationRulesForType(t.type)]},null,8,["label","modelValue","onUpdate:modelValue","placeholder","rules"])]))])))),128))]),(0,n.createElementVNode)("div",De,[(0,n.createVNode)(s,{label:"",contract:e.fields.contract,action_name:e.fields.name},null,8,["contract","action_name"]),(0,n.createVNode)(d,{icon:"mdi-plus",disabled:e.addToBucketAllowed,label:"add to bucket",color:"primary",onClick:e.addToBucket},null,8,["disabled","onClick"])])])}const Oe=["uint8","int8","uint16","int16","uint32","uint64","int64","int32","varuint32","varint32","uint128","int128","float32","float64","float128"],Pe=(0,n.defineComponent)({name:"actionFields",components:{thresholdBadge:ee.Z},props:{fields:{type:Object,default:()=>({})}},data(){return{action_fields:""}},computed:{...(0,i.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup",getLinkedThresholdForContractAction:"group/getLinkedThresholdForContractAction",getModules:"group/getModules"}),addToBucketAllowed(){let e=!1;return e}},methods:{async addToBucket(){let e={account:this.fields.contract,name:this.fields.name,authorization:[{actor:this.getActiveGroup,permission:"owner"}],data:{}},t=!1;this.getModules&&this.getModules.length&&(t=this.getModules.find((e=>e.slave_permission.actor==this.fields.contract))),t&&(e.authorization=[t.slave_permission]),this.action_fields.fields.forEach((t=>{let o=String(t.value).trim();o.includes("[")&&o.includes("]")||o.includes("{")&&o.includes("}")?o=JSON.parse(o):"bool"==t.type?o="true"===o:this.isNumberType(t.type)&&(o=Number(o)),e.data[t.name]=o})),this.$store.dispatch("bucket/addToBucket",{action:e,vm:this})},isNumberType(e){return Oe.includes(e)},getValidationRulesForType(e){let t=[];switch(e){case"name":t.push(P.ZF);break;default:break}return t}},mounted(){this.action_fields=JSON.parse(JSON.stringify(this.fields))}});var Re=o(63314);const je=(0,j.Z)(Pe,[["render",Ue]]),Ge=je;K()(Pe,"components",{QSelect:Re.Z,QInput:H.Z,QBtn:M.Z});var Me=o(40019);const Je=(0,n.defineComponent)({name:"newProposal",components:{pageHeader:l.Z,proposeBucket:xe,findAccount:Te.Z,listActions:Se,actionFields:Ge},data(){return{active_tab:"advanced",selected_contract:"",selected_action_name:"",advanced_slide:"action_selection",active_action_fields:!1}},computed:{...(0,i.Se)({getAccountName:"proton/getAccountName",getActiveGroup:"group/getActiveGroup",getActiveGroupConfig:"group/getActiveGroupConfig",getNumberGuardians:"group/getNumberGuardians"})},methods:{goBackToActionSelection(){let e=window.location.search.substring(1),t=new URLSearchParams(e);t.delete("action"),window.history.replaceState({},"",`${location.pathname}?${t}`),this.selected_action_name="",this.advanced_slide="action_selection"},showActionFields(e){e.contract=this.selected_contract,e.fields=e.fields.map((e=>(e.value="",e))),this.active_action_fields=e;let t=window.location.search.substring(1),o=new URLSearchParams(t);this.active_action_fields.fields.forEach((e=>{e.value=o.get(e.name)||""})),this.advanced_slide="action_fields"},handleInput(e){Me.log(e),this.selected_contract=e}},created(){let e=window.location.search.substring(1),t=new URLSearchParams(e);for(const[o,n]of t){switch(o){case"contract":this.selected_contract=n;break;case"action":this.selected_action_name=n,this.$refs;break}Me.log(o,n)}}});var He=o(24379),We=o(57547),Ke=o(58408);const Xe=(0,j.Z)(Je,[["render",a]]),Ye=Xe;K()(Je,"components",{QPage:He.Z,QTabs:We.Z,QTab:Ke.Z,QSeparator:le.Z,QTabPanels:_e.Z,QTabPanel:be.Z,QBtn:M.Z})}}]);